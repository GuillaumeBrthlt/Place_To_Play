<div class="container h-100 py-2">
  <div class="mb-4">
    <% if current_user.is_artist %>
      <%= link_to "Retour", performances_path %>
    <% else %>
      <%= link_to "Retour", dashboard_path(current_user.id) %>
    <% end %>
  </div>
  <div class="container mt-4 card p-0 mb-5">

    <div class="event_header d-flex flex-row flex-wrap">
      <div class="col-md-8 p-0">
        <%= image_tag "performance.jpg", style: "width: 100%; border-top-left-radius: 8px"%>
      </div>
      <div class="col-md-4 p-3 d-flex flex-column align-items-center justify-content-center">
        <h1 class="mb-4"><%= @performance.name %></h1>
        <h3><%= @performance.date_time%></h3>
        <h4><%= @performance.duration%> minutes</h4>
        <h5><%= @performance.venue_profile.city %> (<%= @performance.venue_profile.zip_city %>)</h5>
      </div>
    </div>

    <div class=" d-flex flex-row flex-wrap" style="border-bottom: 1px solid rgba(255, 255, 255, 0.231); border-top: 1px solid rgba(255, 255, 255, 0.231)" >
      <div class="col-lg-8 col-md-4 py-3 ps-5 d-none d-sm-block">
        <% if current_user.is_venue %>
            <% if @performance.venue_profile_id == current_user.venue_profile.id %>
              <div class="d-flex justify-content-between align-items-center mb-3">
                <%= link_to "Modifier mes genres", new_performance_performance_genre_path(performance_id: @performance.id), class:"btn btn-secondary my-1" %>
              </div>
            <% end %>
          <% end %>

          <% if current_user.is_venue %>
          <% if @performance.venue_profile_id == current_user.venue_profile.id %>
            <div class="d-flex justify-content-between align-items-center mb-3 flex-sm-column flex-lg-row flex-wrap">
              <%= link_to "Modifier la performance", edit_performance_path(@performance.id), class:"btn btn-primary my-1" %>
            </div>
          <% end %>
        <% else %>
          <% if current_user.artist_profile.performances.include?(@performance)%>
            <p class="btn btn-danger disabled my-1">Vous avez déjà postulé</p>
          <% else %>
            <%= link_to "Postuler !", new_performance_application_path(performance_id: @performance.id), class:"btn btn-danger my-1" %>
            <% end %>
        <% end %>
      </div>
      <h5><% @performance.genres.each do |genre| %>
            <%= genre.title %>
          <% end %></h5>
        
          <p><% if @performance.public_event? %></p>
            <p>Évènement public</p>
          <% else %>
            <p>Évènement privé</p>
          <% end %>
        
        <% if current_user.is_venue %>
          <% if @performance.venue_profile_id == current_user.venue_profile.id %>
            <p>Cet évènement a lieu chez vous !</p>
          <% else %>
            <%= link_to "voir le profil de l'établissement", venue_profile_path(@performance.venue_profile.id) %>
          <% end %>
          <% elsif current_user.is_artist %>
          <%= link_to "voir le profil de l'établissement", venue_profile_path(@performance.venue_profile.id) %>
        <% end %>
      <div>

      
    </div>

    <div class="row" >
      <div class="col-md-8 p-4">
        <h3>À propos de cette prestation :</h3>
          <p><%= @performance.description%></p>
      </div>

    </div>

    <div class="container mt-2 pt-lg-2 pb-5">
      <div class="accordion" id="accordionExample">
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingOne">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
              Ils ont postulé :
            </button>
          </h2>
          <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#accordionExample" style="">
            <div class="accordion-body">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th scope="col">Nom</th>
                    <th scope="col">Profil</th>
                  </tr>
                </thead>
                <tbody>
                  <% if find_application && !@application.empty? %>
                  <% @application.each do |application| %>
                <tr class="table-active">
                  <td><%= application.artist_profile.name %> </td>
                  <td><%= link_to "voir le profil de l'artiste", artist_profile_path(application.artist_profile.id) %> </td>
                  <% end %>
                </tr>
                  <% else %>
                    <tr>Aucun artiste n'a encore postulé</tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
